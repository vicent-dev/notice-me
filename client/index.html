<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
</head>
<body>
<label>Your User ID: </label>
<input id="id" type="text" name="id" disabled/>
<br>

<h2>Notification publish</h2>
<label>Client Id</label>
<input id="clientId" type="text" name="id" value="*" />
<label>Client Group Id</label>
<input id="clientGroupId" type="text" name="groupId" value="*" />

<label>Text</label>
<input id="notification-body" type="text" name="body"/>
<button type="submit" onclick="createNotification()">Create</button>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script src="notice-me.js"></script>

<script>
    const PROTOCOL = 'http';
    const SERVER_URL = window.location.hostname + ':8090';

    function generateRandomUserId() {
        document.getElementById('id').value = Math.floor(Math.random() * 1000);
    }

    function createNotification() {
        const xhr = new XMLHttpRequest();

        let clientId = document.getElementById('clientId').value;
        let clientGroupId = document.getElementById('clientGroupId').value;

        if (!clientId) {
            clientId = '*';
        }

        if(!clientGroupId) {
            clientGroupId = '*';
        }

        xhr.open("POST", `${PROTOCOL}://${SERVER_URL}/api/notification`, true);
        xhr.send(JSON.stringify({
            "clientId": clientId,
            "clientGroupId": clientGroupId,
            "body": document.getElementById('notification-body').value,
        }));
    }

    generateRandomUserId();
</script>
<script type="module">
    import noticeMe from "./notice-me.js";
    let id = document.getElementById('id').value;

    if (!id) {
        id = '*';
    }

    const groupId = '*';


    // noticeMe((notificationBody) => console.log(notificationBody));
    console.log('noticeMe imported');
    noticeMe(id, groupId);
</script>
</body>
</html>
